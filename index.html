<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DJIæ¤ä¿æ©Ÿ å™´ç‘ç•ç”¨é‡è¨ˆç®—å™¨</title>
    <style>
        :root {
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --text-main: #1f2937;
            --text-sub: #4b5563;
            --primary: #2563eb;       /* è—è‰²ä¸»èª¿ */
            --accent: #d97706;        /* æ©˜é»ƒå¼·èª¿ */
            --input-bg: #fff;
            --input-border: #d1d5db;
            --input-text: #111827;
            --result-bg: #eff6ff;
            --result-border: #bfdbfe;
        }

        /* å¤œé–“æ¨¡å¼ (Dark Mode) - é‡å°æˆ¶å¤–ä½å…‰æºå„ªåŒ– */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #0f172a;  /* æ·±è—é»‘èƒŒæ™¯ */
                --card-bg: #1e293b;   /* å¡ç‰‡æ·±ç° */
                --text-main: #f3f4f6; /* æ–‡å­—åç™½ */
                --text-sub: #9ca3af;
                --primary: #60a5fa;   /* äº®è— */
                --accent: #fbbf24;    /* äº®é»ƒ */
                
                /* é—œéµï¼šè¼¸å…¥æ¡†ç¶­æŒé»ƒåº•é»‘å­—ï¼Œç¢ºä¿å¤œé–“æœ€é«˜å°æ¯”åº¦ */
                --input-bg: #fbbf24;
                --input-border: #b45309;
                --input-text: #000000; 
                
                --result-bg: rgba(37, 99, 235, 0.2);
                --result-border: #1e40af;
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            -webkit-text-size-adjust: 100%;
        }

        /* é ‚éƒ¨å°èˆª Tabs */
        .nav-tabs {
            display: flex;
            background: var(--card-bg);
            padding: 10px 10px 0 10px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 15px 0;
            font-size: 16px;
            font-weight: bold;
            color: var(--text-sub);
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-item.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        /* å…§å®¹å®¹å™¨ */
        .container {
            padding: 15px;
            max-width: 600px;
            margin: 0 auto;
            padding-bottom: 50px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }
        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        h2 {
            margin-top: 0;
            font-size: 18px;
            border-left: 4px solid var(--accent);
            padding-left: 10px;
            margin-bottom: 15px;
            color: var(--text-main);
        }

        /* è¼¸å…¥æ¡†çµ„ */
        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-size: 14px;
            color: var(--text-sub);
            margin-bottom: 6px;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 12px 10px;
            font-size: 18px; /* å¤§å­—é«”é˜²æ­¢ iOS Zoom */
            border: 1px solid var(--input-border);
            border-radius: 8px;
            background-color: var(--input-bg);
            color: var(--input-text);
            font-weight: bold;
            box-sizing: border-box;
            outline: none;
        }

        input:focus {
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
            border-color: var(--primary);
        }

        /* çµæœé¡¯ç¤ºå€å¡Š */
        .result-box {
            background-color: var(--result-bg);
            border: 1px solid var(--result-border);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-top: 10px;
        }

        .result-title {
            font-size: 13px;
            color: var(--text-sub);
            margin-bottom: 4px;
        }

        .result-value {
            font-size: 28px;
            font-weight: 900;
            color: var(--primary);
        }

        .result-unit {
            font-size: 14px;
            color: var(--text-sub);
        }

        .result-sub {
            font-size: 12px;
            color: var(--accent);
            margin-top: 4px;
            font-weight: bold;
        }

        /* æŒ‰éˆ•æ¨£å¼ (ç”¨æ–¼è¾²è—¥è¨ˆç®—) */
        button.btn-calc {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
            cursor: pointer;
        }
        button.btn-calc:active {
            transform: scale(0.98);
        }

        /* è—¥é‡è¨ˆç®—çš„åˆ‡æ›é–‹é—œ */
        .toggle-group {
            display: flex;
            background: #e5e7eb;
            padding: 4px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .toggle-btn {
            flex: 1;
            text-align: center;
            padding: 8px;
            font-size: 14px;
            border-radius: 6px;
            cursor: pointer;
            color: #4b5563;
        }
        .toggle-btn.active {
            background: white;
            color: var(--primary);
            font-weight: bold;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        @media (prefers-color-scheme: dark) {
            .toggle-group { background: #374151; }
            .toggle-btn { color: #9ca3af; }
            .toggle-btn.active { background: #1f2937; color: var(--accent); }
        }

    </style>
</head>
<body>

    <div class="nav-tabs">
        <div class="nav-item active" onclick="switchMainTab('tab-drone', this)">
            ğŸš DJIæ¤ä¿æ©Ÿ å™´ç‘ç•ç”¨é‡è¨ˆç®—å™¨
        </div>
        <div class="nav-item" onclick="switchMainTab('tab-pesticide', this)">
            ğŸ§ª å‚³çµ±è¾²è—¥ç¨€é‡‹
        </div>
    </div>

    <div class="container">

        <div id="tab-drone" class="tab-content active">
            
            <div class="card">
                <h2>è¨ˆç®—å™´ç‘ç”¨é‡</h2>
                
                <div class="input-group">
                    <label>æ¯åˆ†åœ°å™´ç‘ç”¨é‡ (å…¬å‡=å‡)</label>
                    <input type="number" id="sprayPerFen" placeholder="ä¾‹å¦‚ï¼š10" oninput="calcDrone()">
                </div>

                <div class="result-box">
                    <div class="result-title">è¨­å®šå™´ç‘ç•ç”¨é‡å€¼ (è‡ªå‹•è£œå„Ÿ +0.5)</div>
                    <div>
                        <span class="result-value" id="sprayPerMu">0.00</span>
                        <span class="result-unit">(å‡/ç•)</span>
                    </div>
                </div>

                <div class="input-group" style="margin-top:20px;">
                    <label>è«‹è¼¸å…¥å¯¦éš›ä½œæ¥­é¢ç© (ç•)ï¼š</label>
                    <input type="number" id="actualMu" placeholder="ä¾‹å¦‚ï¼š7.5" oninput="calcDrone()">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="result-box">
                        <div class="result-title">æ­¤åœ°å¡Šå¯¦éš›ä½œæ¥­é¢ç©(åˆ†)</div>
                        <div>
                            <span class="result-value" id="fenResult" style="font-size: 22px;">0.00</span>
                            <span class="result-unit">(åˆ†)</span>
                        </div>
                    </div>
                    <div class="result-box">
                        <div class="result-title">å¯¦éš›ä½œæ¥­é¢ç©å™´ç‘ç¸½è—¥é‡(å…¬å‡)</div>
                        <div>
                            <span class="result-value" id="totalSprayMu" style="font-size: 22px; color: var(--accent);">0.00</span>
                            <span class="result-unit">(å…¬å‡)</span>
                        </div>
                    </div>
                </div>

                <div class="result-box" style="background: rgba(255, 69, 0, 0.1); border-color: rgba(255, 69, 0, 0.3); margin-top: 22px;">
                    <div class="result-title">ä¸€ç”²åœ° (ç´„ 14.54 ç•) éœ€è¦çš„è—¥æ°´ç”¨é‡</div>
                    <div>
                        <span class="result-value" id="sprayPerJia" style="color: #ff4500;">0.00</span>
                        <span class="result-unit">(å…¬å‡)</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>æ¤ä¿ç„¡äººæ©Ÿåƒæ•¸ç´€éŒ„(æ‰‹å‹•)</h2>
                <div class="input-group">
                    <label>è¨­å®šç•ç”¨é‡ (å‡/ç•)</label>
                    <input type="number" id="record_mu_dosage" readonly style="background: var(--bg-color); color: var(--text-sub); border:none;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="input-group">
                        <label>æµé€Ÿ (å‡/åˆ†é˜)</label>
                        <input type="number" id="record_flow">
                    </div>
                    <div class="input-group">
                        <label>é€Ÿåº¦ (ç§’/å…¬å°º)</label>
                        <input type="number" id="record_speed">
                    </div>
                </div>
                <div class="input-group">
                    <label>ç¸½è—¥é‡ï¼ˆå‡ï¼‰</label>
                    <input type="number" id="record_total">
                </div>
            </div>
        </div>


        <div id="tab-pesticide" class="tab-content">
            
            <div class="card">
                <div class="toggle-group">
                    <div class="toggle-btn active" onclick="switchPesMode('mode-dilution', this)">ğŸ’§ ç®—ç¨€é‡‹ (å·²çŸ¥è—¥é‡)</div>
                    <div class="toggle-btn" onclick="switchPesMode('mode-amount', this)">ğŸ’Š ç®—è—¥é‡ (å·²çŸ¥æ°´é‡)</div>
                </div>

                <div id="mode-dilution" class="pes-mode">
                    <div class="input-group">
                        <label>è¾²è—¥åç¨± (é¸å¡«)</label>
                        <input type="text" id="p_name" placeholder="ä¾‹å¦‚ï¼šç´ä¹ƒå¾—">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div class="input-group">
                            <label>è—¥é‡ (cc/g)</label>
                            <input type="number" id="p_amount" placeholder="500">
                        </div>
                        <div class="input-group">
                            <label>ç¨€é‡‹å€æ•¸</label>
                            <input type="number" id="p_ratio" placeholder="1000">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>é ç•™æ°´é‡ (å…¬å‡, é¸å¡«)</label>
                        <input type="number" id="p_reserve" placeholder="0">
                        <div style="font-size:12px; color:var(--text-sub); margin-top:4px;">* è¨ˆç®—ç¸½é‡æ™‚æœƒç›´æ¥åŠ ä¸Šæ­¤æ•¸å€¼</div>
                    </div>

                    <button class="btn-calc" onclick="calcDilution()">è¨ˆç®—é…æ¯”</button>

                    <div id="dilution-result" style="display:none; margin-top: 20px;">
                        <div class="result-box">
                            <div class="result-title">éœ€è¦åŠ å…¥çš„æ°´é‡</div>
                            <div>
                                <span class="result-value" id="res_water_need">0</span>
                                <span class="result-unit">L</span>
                            </div>
                        </div>
                        <div class="result-box">
                            <div class="result-title">ç¸½è—¥æ¶²é‡ (è—¥+æ°´)</div>
                            <div>
                                <span class="result-value" id="res_total">0</span>
                                <span class="result-unit">L</span>
                            </div>
                        </div>
                        <div class="result-box" id="box_reserve" style="display:none; border-color: var(--accent);">
                            <div class="result-title" style="color: var(--accent);">ç¸½é‡ + é ç•™é‡</div>
                            <div>
                                <span class="result-value" id="res_total_reserve" style="color: var(--accent);">0</span>
                                <span class="result-unit">L</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="mode-amount" class="pes-mode" style="display:none;">
                    <div class="input-group">
                        <label>ç›®æ¨™ç¸½æ°´é‡ (å…¬å‡)</label>
                        <input type="number" id="a_water" placeholder="ä¾‹å¦‚ï¼š100">
                    </div>
                    <div class="input-group">
                        <label>ç¨€é‡‹å€æ•¸</label>
                        <input type="number" id="a_ratio" placeholder="ä¾‹å¦‚ï¼š500">
                    </div>

                    <button class="btn-calc" onclick="calcAmount()">è¨ˆç®—éœ€è—¥é‡</button>

                    <div id="amount-result" style="display:none; margin-top: 20px;">
                        <div class="result-box">
                            <div class="result-title">éœ€è¦è¾²è—¥é‡</div>
                            <div>
                                <span class="result-value" id="res_pest_need">0</span>
                                <span class="result-unit">cc (æˆ–å…‹)</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

<script>
    // --- UI åˆ‡æ›é‚è¼¯ ---
    function switchMainTab(tabId, btn) {
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        
        // Show selected
        document.getElementById(tabId).classList.add('active');
        btn.classList.add('active');
    }

    function switchPesMode(modeId, btn) {
        document.querySelectorAll('.pes-mode').forEach(el => el.style.display = 'none');
        document.querySelectorAll('.toggle-btn').forEach(el => el.classList.remove('active'));
        
        document.getElementById(modeId).style.display = 'block';
        btn.classList.add('active');
    }

    // --- è‡ªå‹•å…¨é¸åŠŸèƒ½ (æ–¹ä¾¿ä¿®æ”¹æ•¸å­—) ---
    document.querySelectorAll("input").forEach(el => {
        el.addEventListener("click", function() {
            this.select();
        });
    });

    // --- åŠŸèƒ½ 1: ç„¡äººæ©Ÿè¨ˆç®— (å·²ä¿®æ­£ç‚ºèˆ‡ dji_pestcontrol.html é‚è¼¯ä¸€è‡´) ---
    function calcDrone() {
        const sprayPerFen = parseFloat(document.getElementById('sprayPerFen').value);
        const actualMu = parseFloat(document.getElementById('actualMu').value);

        // å¸¸æ•¸å®šç¾©
        const muToFen = 0.687; // 1 Mu = 0.687 åˆ†
        const jiaCoef = 14.54; // 1 ç”²åœ°ä¿‚æ•¸

        if (!isNaN(sprayPerFen)) {
            // å…¬å¼ 1ï¼šç•ç”¨é‡ = (åˆ†åœ°ç”¨é‡ * 0.687) + 0.05
            const sprayPerMuNum = (sprayPerFen * muToFen) + 0.05;
            const sprayPerMu = sprayPerMuNum.toFixed(2);
            
            document.getElementById('sprayPerMu').textContent = sprayPerMu;
            document.getElementById('record_mu_dosage').value = sprayPerMu;

            // å…¬å¼ 2ï¼šä¸€ç”²åœ°ç”¨é‡ = 14.54 * ç•ç”¨é‡
            // (è¨»: 1ç”² = 10åˆ†ã€‚è‹¥1åˆ†å™´10Lï¼Œ10åˆ†=100Lã€‚ 14.54 * (10*0.687) = 14.54 * 6.87 = 99.88 â‰ˆ 100ã€‚é‚è¼¯æ­£ç¢º)
            const sprayPerJia = (jiaCoef * sprayPerMuNum).toFixed(2);
            document.getElementById('sprayPerJia').textContent = sprayPerJia;

            if (!isNaN(actualMu)) {
                // å…¬å¼ 3ï¼šæ›ç®—åˆ†åœ° = å¯¦éš›ç•æ•¸ * 0.687
                const fenResult = (actualMu * muToFen).toFixed(2);
                document.getElementById('fenResult').textContent = fenResult;

                // å…¬å¼ 4ï¼šæœ¬è¶Ÿç¸½è—¥é‡ = å¯¦éš›ç•æ•¸ * ç•ç”¨é‡
                const totalSprayMu = (actualMu * sprayPerMuNum).toFixed(2);
                document.getElementById('totalSprayMu').textContent = totalSprayMu;
            } else {
                document.getElementById('fenResult').textContent = "0.00";
                document.getElementById('totalSprayMu').textContent = "0.00";
            }
        }
    }

    // --- åŠŸèƒ½ 2: å‚³çµ±è¾²è—¥è¨ˆç®— ---
    
    // A. ç®—ç¨€é‡‹ (å·²çŸ¥è—¥é‡ï¼Œæ±‚æ°´é‡)
    function calcDilution() {
        const amount = parseFloat(document.getElementById("p_amount").value);
        const dilution = parseFloat(document.getElementById("p_ratio").value);
        const reserve = parseFloat(document.getElementById("p_reserve").value) || 0;

        if (isNaN(amount) || isNaN(dilution) || amount <= 0 || dilution <= 0) {
            alert("è«‹è¼¸å…¥æ­£ç¢ºçš„è—¥é‡èˆ‡å€æ•¸");
            return;
        }

        const amountL = amount / 1000; // è½‰å…¬å‡
        const waterNeeded = amountL * (dilution - 1); // ç¨€é‡‹æ°´é‡
        const total = amountL + waterNeeded; // ç¸½é‡
        const totalWithReserve = total + reserve;

        document.getElementById("res_water_need").textContent = waterNeeded.toFixed(2);
        document.getElementById("res_total").textContent = total.toFixed(2);
        
        // é¡¯ç¤ºçµæœå€
        document.getElementById("dilution-result").style.display = "block";
        
        // å¦‚æœæœ‰é ç•™é‡ï¼Œé¡¯ç¤ºé¡å¤–è³‡è¨Š
        const boxReserve = document.getElementById("box_reserve");
        if (reserve > 0) {
            document.getElementById("res_total_reserve").textContent = totalWithReserve.toFixed(2);
            boxReserve.style.display = "block";
        } else {
            boxReserve.style.display = "none";
        }
    }

    // B. ç®—è—¥é‡ (å·²çŸ¥æ°´é‡ï¼Œæ±‚è—¥é‡)
    function calcAmount() {
        const water = parseFloat(document.getElementById("a_water").value);
        const ratio = parseFloat(document.getElementById("a_ratio").value);

        if (isNaN(water) || isNaN(ratio) || water <= 0 || ratio <= 0) {
            alert("è«‹è¼¸å…¥æ­£ç¢ºçš„æ°´é‡èˆ‡å€æ•¸");
            return;
        }

        // å…¬å¼ï¼š(æ°´é‡ / å€æ•¸) * 1000 = cc
        const pestNeeded = (water / ratio) * 1000;

        document.getElementById("res_pest_need").textContent = pestNeeded.toFixed(1);
        document.getElementById("amount-result").style.display = "block";
    }

</script>
</body>
</html>